define('kg/xtab/1.0.0/index',["kg/xscroll/2.3.0/base","kg/xscroll/2.3.0/util","kg/xscroll/2.3.0/core","kg/xscroll/2.3.0/event","kg/xscroll/2.3.0/tap","node"],function(require, exports, module) {function e(t){var r=this;t&&t.renderTo&&(e.superclass.constructor.call(this),r.cfg=n.mix({maskNode:"",itemsSelector:".xtab-item",duration:300,easing:"ease",headerTitle:""},t),r.init())}var t=require("kg/xscroll/2.3.0/base"),n=require("kg/xscroll/2.3.0/util"),r=require("kg/xscroll/2.3.0/core"),i=require("kg/xscroll/2.3.0/event"),a=require("kg/xscroll/2.3.0/tap"),o=require("node").all,s=function(e,t){for(var n in t)if(e==t[n])return n};n.extend(e,t,{init:function(){var e=this,t=e.cfg;e.renderTo=document.querySelector(t.renderTo),e.navContainer=e.renderTo.querySelector(".xtab-nav-container"),e.items=e.navContainer.querySelectorAll(e.cfg.itemsSelector),e.btnSlide=e.renderTo.querySelector(".xtab-btn-slide"),e.itemsLength=e.items.length,e.itemData=[];for(var n=0;n<e.items.length;n++)e.itemData.push(e.items[n].innerHTML);e.xscroll=new r({renderTo:e.navContainer,scrollbarX:!1,scrollbarY:!1,lockY:!0})},switchTo:function(e){var t=this;if(!(void 0===e||0>e||e>=t.itemsLength)){t.prevIndex=t.curIndex;var r=t.items[e],i=t.popItems[e],a=r.offsetLeft,o=t.xscroll.width,s=t.xscroll.containerWidth-t.xscroll.width,l=a-o/2+r.offsetWidth/2<0?0:a-o/2+r.offsetWidth/2;l=l>s?s:l;for(var d in t.items)n.removeClass(t.items[d],"active"),n.removeClass(t.popItems[d],"active");n.addClass(r,"active"),n.addClass(i,"active"),t.xscroll.scrollX(l,t.cfg.duration),t.curIndex=e,t.fire("switch",{curIndex:e}),t.curIndex!==t.prevIndex&&t.fire("switchchange",{prevIndex:t.prevIndex,curIndex:t.curIndex})}},findParentEl:function(e,t,n){var r=o(e),i=null;if(n=n||document.body,e&&t){for(;!i&&(i=r.parent(t)&&r.parent(t)[0],r[0]!=n);){if(i)return o(i);r=r.parent()}return null}},_bindEvt:function(){var e=this;e._isEvtBind||(e._isEvtBind=!0,e.xscroll.on("click",function(t){t.preventDefault();var n=o(t.target);if(n.hasClass("xtab-item")||(n=e.findParentEl(t.target,".xtab-item",e.xscroll.renderTo)),n){var r=s(n[0],e.items);e.switchTo(r)}}),e.btnSlide&&i.on(e.btnSlide,a.TAP,function(){e.toggleSide()}),e.mask&&e.mask.addEventListener("touchstart",function(t){t.preventDefault(),e.slideUp()}),e.mask&&e.mask.addEventListener("touchmove",function(e){e.preventDefault()}),e.mask&&e.mask.addEventListener("webkitTransitionEnd",function(t){t.target==e.mask&&(e.mask.style.display="none")},!1),e.pop&&e.pop.addEventListener("touchmove",function(e){e.preventDefault()}),e.pop&&i.on(e.pop,a.TAP,function(t){if(t.preventDefault(),"li"==t.target.tagName.toLowerCase()){var n=s(t.target,e.popItems);e.switchTo(n),e.slideUp()}}))},render:function(){var e=this;e.xscroll.render(),e._renderPop(),n.addClass(e.mask,"xtab-mask"),e._bindEvt()},toggleSide:function(){this._isSlideDown?this.slideUp():this.slideDown()},slideDown:function(){var e=this;e._isSlideDown=!0,e.mask.style.display="block",e.mask.style.opacity=.5,e.pop.style.display="block",n.addClass(e.renderTo,"xtab-slide-down")},slideUp:function(){var e=this;e._isSlideDown=!1,e.mask.style.opacity=0,e.pop.style.display="none",n.removeClass(e.renderTo,"xtab-slide-down")},_renderMask:function(){var e=this;e.mask=e.cfg.maskNode&&document.querySelector(e.cfg.maskNode),e.mask||(e.mask=document.createElement("div"),e.mask.style.display="none",e.mask.opacity=0,document.body.appendChild(e.mask))},_renderPop:function(){var e=this;e._renderMask(),e.pop||(e.pop=document.createElement("div"),e.pop.className="xtab-navpop-container",e.renderTo.appendChild(e.pop));var t="<ul>";for(var n in e.itemData)t+="<li>"+e.itemData[n]+"</li>";e.pop.innerHTML='<span class="xtab-navpop-header">'+(e.cfg.headerTitle||"")+"</span>"+t,e.popItems=e.pop.querySelectorAll("li")}}),module.exports=e;});